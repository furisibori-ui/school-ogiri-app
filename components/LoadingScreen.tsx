'use client'

import { useEffect, useRef, useState } from 'react'
import { motion, AnimatePresence } from 'framer-motion'

// 準備→本番の順で表示（時間がかかっても自然な流れに）
const loadingMessages準備 = [
  '設立準備委員会の第一回会議を開いてます...',
  '候補地の地価を三箇所で比較中...',
  '建築確認申請の書類を揃えてます...',
  '設計事務所の入札を公告中...',
  '校舎の間取りを第一案で検討中...',
  '敷地の地盤調査の業者を手配中...',
  '創立記念日の候補をカレンダーで確認中...',
  '校名の公募の締め切りを延長してます...',
  '校章のデザインコンペの審査員を依頼中...',
  '校歌の作詞を地域の詩人に打診中...',
  '校訓の候補を5案に絞ってます...',
  '制服のサンプルを三社から取り寄せ中...',
  '通学区域の線引きを市と協議中...',
  '第一期の生徒定員を計算し直してます...',
  '教員の採用枠を県に申請中...',
  '校長候補の面接を明日に控えてます...',
  '教頭の異動の内示が来るのを待ってます...',
  '事務職員の募集要項を書いてます...',
  '用務員の宿直シフトを検討中...',
  '給食室の業者を公募で選定中...',
  '教材の見本を各社から取り寄せ中...',
  '黒板のサイズを教室に合わせてます...',
  '椅子の高さを学年別に発注リスト作成中...',
  'ロッカーの鍵を一括で発注してます...',
  '校庭の面積を測量し直してます...',
  '体育館の天井の高さをバスケ規格で確認中...',
  'プールの水深を公認サイズで設計中...',
  '図書室の書架の数を蔵書目標で逆算中...',
  '理科室のガス栓の数を数えてます...',
  '音楽室の防音工事を業者に見積もり依頼中...',
  '職員室のデスク配置を図面で検討中...',
  '校長室の応接セットをカタログで選んでます...',
  '保健室のベッドを2台で足りるか検討中...',
  '給食室の配膳ルートを廊下幅で確認中...',
  '体育倉庫の扉の幅をマットが通るか測ってます...',
  '正門の門柱のデザインを三案で比較中...',
  '駐輪場の収容台数を通学手段調査で算出中...',
  '駐車場の保護者用スペースを何台にするか決めてます...',
  '校舎の外壁の色をパントンで指定中...',
  '屋上の防水工事を五年保証で契約してます...',
  '避難階段の幅を消防署と確認中...',
  '非常階段の照明を蓄光式で手配中...',
  '消火器の設置箇所を図面に落としてます...',
  '防犯カメラの台数と角度を業者と打ち合わせ中...',
  'インターホンの音を三種類から選んでます...',
  '校内LANの配線図をネットワーク業者と作成中...',
  'Wi-Fiのアクセスポイントを何台にするか検討中...',
  '黒板の電子化を一部教室で試すか検討中...',
  'プロジェクターの常設を全教室にするか決めてます...',
  '空調の能力を教室の広さで再計算中...',
  '窓の開閉が鍵で固定できるか確認してます...',
  'カーテンの色を校章に合わせてます...',
  '掲示板のピンの在庫を初年度分で発注中...',
  '時計の電池式と電波式どちらにするか検討中...',
  '校庭のスプリンクラーの範囲を図面で確認中...',
  'グラウンドの排水溝の位置を業者と決めてます...',
  'フェンスの高さを規制と照合中...',
  '花壇の土を園芸用で何立方メートルか算出中...',
  '校庭の桜の苗を何本注文するか数えてます...',
  '正門の植栽を常緑と落葉どちらにするか検討中...',
  '創立者の胸像の台座の高さを決めてます...',
  '校訓の石碑の石材を産地で比較中...',
  '掲揚塔の高さを周辺の建物と調整中...',
  '校旗のサイズを体育館の天井に合わせてます...',
  '校歌の楽譜を何部印刷するか見積もり中...',
  '生徒手帳のページ数をリストアップしてます...',
  '校則の条数を第一版で何条にするか検討中...',
  '時間割の枠を週何コマにするか県の基準で確認中...',
  '年間行事の日数をカレンダーに書き込んでます...',
  '入学式の式次第の文案を書いてます...',
  '卒業式の来賓リストを市に照会中...',
  '文化祭の日程を土日どちらにするか決めてます...',
  '体育祭の種目を昨年度の他校を参考にリストアップ中...',
  '修学旅行の行き先を三候補に絞ってます...',
  '遠足の下見を担当が来週行く予定です...',
  '三者面談の期間を何日間にするか検討中...',
  '授業参観の回数を年間で決めてます...',
  'PTA総会の日時を役員と調整中...',
  '地域懇談会の会場を体育館で確保してます...',
  '防災訓練の想定を地震と火災で二本用意してます...',
  '引き渡し訓練のシナリオを書いてます...',
  '給食のアレルギー対応表の様式をダウンロード中...',
  '保健室の救急箱の中身リストを看護師に確認してもらってます...',
  '名簿のフォーマットをExcelで作ってます...',
  '出席簿の様式を県の指定で確認中...',
  '指導要録の記入例を研修で配布予定です...',
  '通知表の様式を三学期制で作成中...',
  '調査書のテンプレートをダウンロードしてます...',
  '入学案内のパンフレットのページ数を決めてます...',
  '学校要覧の写真をどこで撮るかリストアップ中...',
  'ホームページのドメインを取得してます...',
  '学校だよりの初号の原稿を校長に依頼中...',
  '緊急連絡網の様式を配布用に印刷してます...',
  '保険の加入手続きの書類を業者から取り寄せ中...',
  '備品の棚卸し用の一覧表をExcelで作ってます...',
  '消耗品の初年度発注リストを各担当で作成中...',
  '鍵の本数を各部屋で数えてます...',
  '清掃用具の数を各階のストックで算出中...',
  'ゴミの分別表を市のルールで作ってます...',
  'リサイクルボックスの設置場所を決めてます...',
  '駐輪場の番号札を生徒数分発注してます...',
  '下駄箱の番号を新入生の人数で割り振り表を作ってます...',
  'ロッカーの鍵の予備を一割で発注してます...',
  '名札のクリップが壊れたときの予備を発注中...',
]

const loadingMessages本番 = [
  '開校式の会場の椅子を並べ終わりました...',
  '来賓用の胸花を花屋に発注済みです...',
  '式典のマイクの音量を本番レベルでテスト中...',
  '校旗の掲揚のタイミングを式次第と合わせてます...',
  '校歌の伴奏をCDでリハーサル中...',
  '新入生の名簿を担任に配布しました...',
  '教室の黒板に「歓迎」の文字を書いてます...',
  '廊下の案内表示を最終確認中...',
  'トイレの場所を矢印で示す貼り紙を貼ってます...',
  '受付の名札を並べ直してます...',
  '保護者用のパンフレットを椅子に置いてます...',
  '放送室の機器が本番で動くか点検中...',
  '体育館の照明を全灯で試してます...',
  '窓の開け閉めで風通しを確認中...',
  '非常口の表示が消えてないか点検中...',
  '救急箱を保健室から受付横に持ってきてます...',
  '来賓の席次表を印刷し直してます...',
  '校長の式辞の原稿を最終校正中...',
  '祝電の掲示場所を確保してます...',
  '記念撮影の場所を校庭のどこにするか決めてます...',
  '校門の横断幕が風で飛ばないか確認中...',
  '玄関の靴の並びをそろえてます...',
  '職員の名札を全員分揃えてます...',
  '開始5分前のアナウンス原稿を確認中...',
  '来賓の誘導係の役割を最終確認中...',
  '保護者の案内をスムーズにするため経路を歩いてます...',
  '駐車場の誘導員のビブスを配ってます...',
  '受付の筆記具が足りるか数えてます...',
  'プログラムの余りを控室にストックしてます...',
  '校歌の歌詞カードを全席に置いてます...',
  'ピアノの椅子の高さを伴奏者が確認中...',
  'マイクのバッテリーを満充電にしました...',
  'カメラの三脚を記念撮影用に設置してます...',
  '花束の受け取り係を最終打ち合わせ中...',
  '式終了後の案内を一枚にまとめてます...',
  '控室の茶菓を並べ直してます...',
  '来賓用の礼品を袋に詰めてます...',
  'アンケート用紙を退場時に配るか検討中...',
  '次の会議の会場を確保してます...',
  '校舎内の案内表示を全部点検してます...',
  '階段の手すりがぐらついてないか確認中...',
  '廊下の照明が全部つくか試してます...',
  'トイレの鍵が開くか全部試してます...',
  '水道の出を全部開けて確認中...',
  'ゴミ箱を空にして新しい袋をセットしてます...',
  '窓ガラスの汚れを拭き終わりました...',
  '床のワックスが乾いたか確認中...',
  '黒板がきれいに拭けてるか確認してます...',
  'チョークの粉を全部払ってます...',
  '教壇の位置を中央に合わせてます...',
  '時計が正確か確認してます...',
  'カーテンの開け具合を揃えてます...',
  '掲示物の角がそろってるか確認中...',
  '掃除用具をストック室に戻しました...',
  '鍵の受け渡しリストを確認中...',
  '戸締まりの担当を割り振ってます...',
  '警備会社に開錠の時間を伝えてます...',
  '翌日の準備のメモを黒板に書いてます...',
  '最終点検のチェックリストを回してます...',
  '校長の最終OKを待ってます...',
  '教育委員会に開校報告の電話をかけてます...',
  'マスコミの取材対応を一本化してます...',
  'SNSの投稿用の写真を選んでます...',
  'ホームページの「開校しました」を更新準備中...',
  '保護者向けメールの下書きを確認中...',
  '翌日の時間割を全教員に配布済みです...',
  '教材の初回分を各教室に配ってます...',
  '給食の初日の献立を業者と最終確認中...',
  'スクールバスの初便の時刻を保護者に伝えてます...',
  '登校指導の担当を正門と裏門で割り振ってます...',
  '下校指導の時間を放送で流す原稿を書いてます...',
  '部活動の仮入部の日程を掲示用にまとめてます...',
  '生徒会の立候補の受付を明日開始する準備中...',
  '図書の貸出カードを全員分用意してます...',
  '保健の身体測定の会場を体育館で確保してます...',
  '避難訓練の初回の日時を全員に周知してます...',
  '防災頭巾の配布を各クラスで予定してます...',
  '名札の写真を撮り直した分をラミネートしてます...',
  'クラス写真の撮影日を業者と決めてます...',
  '生徒手帳の配布を入学式の翌日に予定してます...',
  '校則の読み合わせを一学期中にやるか検討中...',
  '時間割の変更が入ったので印刷し直してます...',
  '担任の自己紹介のスライドを共有フォルダに上げてます...',
  '保護者会の日時を全学年で統一してます...',
  '懇談会の時間枠を保護者の希望で埋めてます...',
  '地域の見守り隊に初登校の日を伝えてます...',
  '近隣への挨拶回りの日程を決めてます...',
  '警察のスクールサポーターに連絡してます...',
  '消防署に避難経路の届け出を出してます...',
  '開校の新聞折り込みの原稿を最終確認中...',
  '地域の回覧板用の案内を書いてます...',
  '公民館にチラシを置く許可を取ってます...',
  '商店街の掲示板に開校案内を貼る準備中...',
  '校門の前の道路の交通量を確認してます...',
  '横断歩道のペイントが剥げてないか点検中...',
  'スクールゾーンの看板が立ってるか確認してます...',
  'バス停の時刻表が最新か確認中...',
  '駐輪場の利用ルールを紙にまとめてます...',
  '駐車場の利用時間を保護者に案内する文を書いてます...',
  '正門の開閉時間を守衛に伝えてます...',
  '夜間照明の点灯時間をタイマーでセットしてます...',
  '警報が鳴ったときの対応を全員で確認中...',
  '台風の際の休校判断を誰がするか決めてます...',
  '大雪のときの対応を市の基準で確認中...',
  '不審者対応のマニュアルを配布してます...',
  'AEDの設置場所を全員に周知してます...',
  '救急搬送の連絡先リストを更新してます...',
  'アレルギー対応のエピペン保管場所を決めてます...',
  '最終チェックの押印を校長がしてます...',
  '開校のゴングを鳴らす係を決めてます...',
  '校門を開ける鍵を誰が持つか確認してます...',
  'あと少しで開校です...',
]

// 中盤・待機ネタ（合計650件になるよう124件）
const loadingMessages中盤 = [
  '職員の健康診断の結果を回収中...',
  '非常食の賞味期限を全品チェック中...',
  '消火器の点検シールを貼り直してます...',
  'AEDの使い方ポスターを掲示してます...',
  '避難経路の矢印が夜光るか確認中...',
  '防災倉庫の在庫をリストに落としてます...',
  '鍵の予備を金庫に収めてます...',
  '警備会社の連絡先を全職員に配布中...',
  '夜間の施錠チェックリストを作ってます...',
  '週末の当番表を印刷してます...',
  '月次の点検日をカレンダーに書き込んでます...',
  '業者の定期訪問日を一覧にまとめてます...',
  '備品の貸出ノートを各階に置いてます...',
  '消耗品のストック場所を貼り紙で示してます...',
  'ゴミ出しの当番を年間で割り振ってます...',
  '窓の開け閉め当番を決めてます...',
  '黒板消しの洗い当番をローテーション中...',
  '給湯室のポットの水を替えてます...',
  '冷蔵庫の庫内を拭いてます...',
  '電子レンジのターンテーブルを洗ってます...',
  '会議室のホワイトボードを消してます...',
  'プロジェクターのレンズをふいてます...',
  'エアコンのフィルターを確認してます...',
  '換気扇の油汚れを拭いてます...',
  '排水口のネットを洗ってます...',
  'トイレの芳香剤を補充してます...',
  '石鹸の在庫を数えてます...',
  'トイレットペーパーのストックを補充してます...',
  'ハンドタオルを新しいのに替えてます...',
  '鏡のくもりを拭いてます...',
  '床の水気をモップで拭いてます...',
  '窓ガラスの指紋を拭いてます...',
  'カーテンのほこりを払ってます...',
  '蛍光灯のチラつきを確認してます...',
  'スイッチの表示を貼り直してます...',
  'コンセントの位置を案内図に書いてます...',
  'LANケーブルの長さを測ってます...',
  'Wi-Fiのパスワードを掲示用に印刷してます...',
  'パソコンのログイン画面を確認してます...',
  'プリンターの用紙を補充してます...',
  'インクの残量をチェックしてます...',
  'コピー機のトナーを替えてます...',
  '電話機の内線一覧を更新してます...',
  'FAXのテスト送信をしてます...',
  '掲示板のピンの数を数えてます...',
  'クリップの在庫を補充してます...',
  'ホッチキスの針を補充してます...',
  '付箋を各デスクに配ってます...',
  'ボールペンの色を統一してます...',
  'チョークの色を全教室分揃えてます...',
  'チョークホルダーを洗ってます...',
  '黒板消しクリーナーの水を替えてます...',
  '教壇の引き出しの鍵を確認してます...',
  'ストップウォッチの電池を替えてます...',
  '拡大鏡のレンズをふいてます...',
  '地球儀の軸が回るか確認してます...',
  '地図のピンの在庫を数えてます...',
  '実験器具の洗浄をしてます...',
  '薬品の保管鍵を閉めてます...',
  'ピペットの先をチェックしてます...',
  '顕微鏡のレンズをふいてます...',
  'ピアノの鍵盤の汚れを拭いてます...',
  '譜面台の角度を揃えてます...',
  '音叉の音程を確認してます...',
  'ミシンの糸を通し直してます...',
  '裁縫箱の針の在庫を確認してます...',
  'コンロの火加減をテストしてます...',
  '包丁の刃を研いでます...',
  'のこぎりの刃のゆがみを確認してます...',
  '万力のネジが回るか点検してます...',
  'ドリルのチャージが足りるか確認してます...',
  '体育館の床のワックスをかけ直してます...',
  'バスケのゴールの高さを測ってます...',
  'バレーのネットの張りを調整してます...',
  'マットの重ね順を確認してます...',
  '跳び箱の段のネジを締め直してます...',
  '鉄棒のさびをチェックしてます...',
  'ボールの空気圧を測ってます...',
  'ラケットのガットの張りを確認してます...',
  'プールの水温を記録してます...',
  '塩素濃度を測定してます...',
  '更衣室の鍵の番号を確認してます...',
  '救命胴衣の数を数えてます...',
  '監視台の椅子の高さを調整してます...',
  '図書室の本の背ラベルを貼り直してます...',
  '貸出カードの在庫を確認してます...',
  'ブックトラックの車輪が動くか点検してます...',
  '書架の高さを揃えてます...',
  '読書用の椅子を並べ直してます...',
  '保健室のベッドのシーツを洗濯してます...',
  '身長計の校正をしてます...',
  '体重計の電池を替えてます...',
  '救急箱の薬の期限をチェックしてます...',
  'アイスパックを冷凍庫で冷やしてます...',
  'ストレッチャーの脚が固定されるか確認してます...',
  '給食室の配膳ワゴンの数を数えてます...',
  '食器の割れがないか確認してます...',
  'はしの向きを揃えてます...',
  'ナプキンの在庫を補充してます...',
  '牛乳の賞味期限を確認してます...',
  '残渣の計量用のスケールを校正してます...',
  '校庭の砂場の砂をならしてます...',
  '遊具のぐらつきを点検してます...',
  '鉄棒の下の砂の量を確認してます...',
  'ブランコの鎖の長さを揃えてます...',
  '滑り台の段差をチェックしてます...',
  '花壇の水やりをしてます...',
  '雑草を抜いてます...',
  '桜の木の剪定を業者に依頼してます...',
  '正門の植栽の水をやってます...',
  'グラウンドのラインを引き直す準備をしてます...',
  'スプリンクラーのノズルを掃除してます...',
  'フェンスの破れがないか確認してます...',
  '駐輪場の番号札が剥がれてないか見てます...',
  '駐車場の白線を塗り直す業者を呼んでます...',
  '正門の門扉の油を差してます...',
  '門柱の照明がつくか確認してます...',
  '表札の字が読めるか拭いてます...',
  '創立者の胸像の台座を拭いてます...',
  '校訓の石碑の苔を取ってます...',
  '掲揚塔のロープがほつれてないか確認してます...',
  '校旗のほこりを払ってます...',
  '玄関の靴箱の番号を貼り直してます...',
  '傘立ての本数を数えてます...',
  '下駄箱の空きを確認してます...',
  '昇降口の「靴を揃えて」の張り紙を貼り直してます...',
  '廊下の掲示物のピンが刺さってるか確認してます...',
  '階段の手すりを拭いてます...',
  '非常灯が点くかテストしてます...',
  '消火器の使い方の説明を読んでます...',
  '防火扉が閉まるか確認してます...',
  '屋上の排水溝を掃除してます...',
  '屋上の手すりの高さを測ってます...',
  '校舎の外壁のひび割れをチェックしてます...',
  '窓枠の塗装が剥げてないか見てます...',
]

const loadingMessages = [
  ...loadingMessages準備,
  // 既存：認可・計画・人事
  '文部科学省に認可申請中...',
  '地域の情報を収集しています...',
  '職員会議で校名を投票中...',
  '校訓を3パターン検討中...',
  '校長を面接中...',
  '校歌を作詞作曲中...',
  '校歌の2番を書いてます...',
  '校則を制定中...',
  '校章をデザイン中...',
  'PTA会長を選出中...',
  '時間割を編成中...',
  '担任の先生を抽選中...',
  '部活動の顧問を配置中...',
  '地域の偉人を一名ピックアップ中...',
  '校史の年表を1887年から作成中...',
  // 中盤：設備・準備作業
  '校庭の草を刈っています...',
  '校舎の耐震工事を実施中...',
  '給食のメニューを考案中...',
  '生徒手帳を印刷中...',
  '校門のプレートを鋳造中...',
  '名簿をExcelで作ってます...',
  '校則の細則を第37条まで作成中...',
  '文化祭のテーマを募集中...',
  '修学旅行の行程を調整中...',
  '入学式の招待状を印刷中...',
  '体育館のステージを掃除中...',
  '黒板のチョークの粉を払ってます...',
  'マイクのテスト中... ポン、ポン',
  '教師が遅刻してます... お待ちください',
  '裏口入学を処理中...',
  'プールのカルキを抜いてます...',
  '図書室の本に蔵書印を押してます...',
  '保健室のベッドをセット中...',
  '給食室の大釜を磨いてます...',
  '職員室のコピー機を修理中...',
  '体育倉庫のボールに空気入れてます...',
  '掲示板の賞状を貼り直してます...',
  '校庭の白線を引き直してます...',
  'チャイムの音を選定中...',
  '週番の先生をローテーション中...',
  '地区懇談会の日程を調整中...',
  '防災訓練のシナリオを執筆中...',
  '卒業式のBGMを選曲中...',
  '新入生の名札を発注中...',
  '同窓会名簿を仮編集成中...',
  '校報の初号をレイアウト中...',
  '校庭の桜の本数を数えてます...',
  '正門の門扉を塗装中...',
  '校歌の楽譜を五線紙に清書中...',
  'PTA会報の原稿を催促中...',
  '文化祭のパンフを製本中...',
  '体育祭のプログラムを印刷中...',
  '三者面談の日程をGoogleカレンダーに投入中...',
  '卒業アルバムの写真を撮影中...',
  '非常ベルを点検中...（誤動作でした）',
  '蛍光灯を一本ずつ交換中...',
  '黒板消しをクリーニング中...',
  '教壇の高さを微調整中...',
  '廊下の掲示物の角を揃えてます...',
  'トイレのスリッパを補充中...',
  '自転車置き場のラインを引き直してます...',
  '校舎の外壁を点検中...',
  '屋上から見える景色を撮影中...',
  // 最後：仕上げ・最終確認（完成に近い）
  '校舎の写真をフォトスタジオで加工中...',
  '校則の文言を最終校正中...',
  '入学案内のパンフレットを製本中...',
  '通学路の安全確認中...',
  '避難経路の表示を設置中...',
  '職員の名札を発注中...',
  '教室のカーテンを洗濯中...',
  '理科室の実験器具を点検中...',
  '音楽室のピアノを調律中...',
  '家庭科室のミシンを整備中...',
  '技術室の工具を整頓中...',
  '視聴覚室のプロジェクターを設定中...',
  'パソコン室のネットワークを接続中...',
  '会議室の椅子を配置し直してます...',
  '校長室の応接セットを磨いてます...',
  '保健室の救急箱を補充中...',
  '給食の献立表を壁に貼ってます...',
  '下駄箱の番号札を付け替えてます...',
  '昇降口の靴を揃えてます...',
  '体育着のサイズを集計中...',
  '名札用の写真を撮影中...',
  'クラス旗のデザインを選考中...',
  '応援歌の歌詞を配布中...',
  '遠足のしおりを配布中...',
  '文化祭の役割を割り振り中...',
  '卒業証書の用紙を手配中...',
  '式典の来賓リストを確認中...',
  '校庭の砂場をならしてます...',
  '花壇の苗を植え替え中...',
  'プールの水温を計測中...',
  'グラウンドの排水溝を掃除中...',
  // 追加：この場所の学校準備・大喜利風（メタ・都道府県一覧系なし）
  '地域の名産を給食の first メニューに押し込み中...',
  '校門の表札の字を地域の書家に頼んでます...',
  '創立者の銅像のポーズを最終確認中...',
  '近所の商店街から寄贈されたのぼりを立ててます...',
  '校庭の土を地元の業者でならしてます...',
  '職員室のコーヒー豆を地域の焙煎屋で発注中...',
  '通学路の危険箇所を一枚の地図にまとめてます...',
  '校歌の2番の「この地」の部分を地名に差し替え中...',
  '体育館の床にワックスをかけ終わったところです...',
  '保健室の体重計の電池を交換中...',
  '図書室の開架を「地域コーナー」で埋めてます...',
  '校長の着任式の横断幕を業者に依頼中...',
  '生徒会の第一回選挙の公示を書いてます...',
  'プール開きの日を天気予報と照らし合わせ中...',
  '地域の古老から聞いた昔話を校史に追記中...',
  '校舎の裏の雑木林に「立入禁止」の札を打ってます...',
  '給食のアレルギー表を全献立で更新中...',
  '職員用の靴箱に名前シールを貼ってます...',
  '体育祭の紅白の色を地域の旗に合わせてます...',
  '文化祭のテーマを地域の歴史とすり合わせ中...',
  '修学旅行の下見報告を教頭が読み返してます...',
  '校則の「頭髪」の項を写真付きで作り直してます...',
  'PTAの初回役員会の会場を確保中...',
  '地域の消防団と避難訓練の日時を調整中...',
  '校庭の朝礼台のマイクのコードを延長中...',
  '理科室のガス栓を全部点検してます...',
  '音楽室の譜面台の数を数え直してます...',
  '家庭科室のコンロの火加減をチェック中...',
  '技術室ののこぎりを研いでます...',
  '校長室のソファのクリーニングを予約中...',
  '会議室のプロジェクターのリモコンを探してます...',
  '昇降口の傘立てを雨の日想定で並べてます...',
  '下駄箱の空きを新入生の人数で割り振り中...',
  '保健室のストレッチャーを廊下幅と照合中...',
  '給食室の配膳ワゴンの数をクラス数で割ってます...',
  '体育倉庫のマットの干し場を確保中...',
  '校庭のスプリンクラーの向きを微調整中...',
  '正門の門柱に校名プレートの下穴を開けてます...',
  '地域の農家から届いた野菜の検収をしてます...',
  '校舎の非常灯が全部点くか点検中...',
  '職員トイレの鍵を3本注文中...',
  '教室の窓の鍵が合うか一本ずつ試してます...',
  '廊下の消火器の期限を全部確認してます...',
  'グラウンドの夜間照明のタイマーをセット中...',
  '校歌の伴奏用CDを業者に発注中...',
  '入学式の保護者用椅子を体育館に並べてます...',
  '卒業式の花の手配を地元の花屋に依頼中...',
  '運動会のプログラムの順番を競技数で割ってます...',
  '文化祭の各クラスの出し物を一覧表にまとめてます...',
  '三者面談の時間割を保護者の希望で埋めてます...',
  '地域の神社の例大祭と体育祭が被らないか確認中...',
  '近所の公民館と会議室の貸し出し日を調整中...',
  'スクールバス停の位置を道路課と詰めてます...',
  '校庭のフェンスの補修箇所に赤テープを貼ってます...',
  '図書室の貸出システムをテスト運用中...',
  '給食の残渣率を昨年度と比較してます...',
  '保健室の救急箱の中身をリスト化してます...',
  '体育館の窓の鍵が合わないので業者を呼んでます...',
  '職員室のプリンターのトナーを替えてます...',
  '校長の名刺を地域の印刷屋に発注中...',
  '校章入りの封筒を在庫確認してます...',
  '生徒手帳の裏表紙に校訓を刷り込んでます...',
  '時間割の空きコマに「総合」を割り当て中...',
  '担任の自己紹介文を一枚にまとめてます...',
  '部活動の顧問一覧を廊下に貼る用にラミネート中...',
  '地域の偉人の肖像を講堂に飾るフレームを選んでます...',
  '校史の年表の誤字を一通り直してます...',
  '同窓会名簿の初版を印刷所に送ってます...',
  '校報の初号のトップ記事を校長に確認してもらってます...',
  '校庭の桜の剪定を業者に依頼中...',
  '正門の門扉の開閉がスムーズか試してます...',
  'PTA会報の表紙の写真を選んでます...',
  '文化祭のパンフの校正をしてます...',
  '体育祭のプログラムの裏に注意事項を追記中...',
  '卒業アルバムの表紙の色を委員会で決めてます...',
  '非常ベルの押し場所にシールを貼り直してます...',
  '蛍光灯の在庫を倉庫で数えてます...',
  '黒板消しの予備を各階のストックに補充中...',
  '教壇のマイクの電池を新品に替えてます...',
  '廊下の掲示板のピンが足りるか数えてます...',
  'トイレのスリッパのサイズ別在庫を補充中...',
  '自転車置き場の番号札を新年度用に刷り直してます...',
  '校舎の外壁のひび割れを業者に報告中...',
  '屋上の手すりの高さを規制と照合してます...',
  '校舎の写真をパンフ用にトリミングしてます...',
  '校則の「服装」の写真をモデル生徒で撮り直してます...',
  '入学案内の地図を実際の通学路と照合中...',
  '通学路の踏切の時間帯をメモしてます...',
  '避難経路の矢印が消えかけてる箇所を塗り直してます...',
  '職員の名札の字体を統一してます...',
  '教室のカーテンの色を全室で揃え直してます...',
  '理科室の薬品の在庫をリストに落としてます...',
  '音楽室のピアノの鍵盤の汚れを拭いてます...',
  '家庭科室の包丁の刃を研いでます...',
  '技術室の電動工具のコードを点検中...',
  '視聴覚室のスピーカーの左右バランスを確認中...',
  'パソコン室のマウスパッドを全席新品に替えてます...',
  '会議室のホワイトボードのマーカーを補充中...',
  '校長室の応接セットの位置を風水で微調整中...',
  '保健室の救急箱の薬の期限をチェックしてます...',
  '給食の献立表の誤字を一枚ずつ直してます...',
  '下駄箱の番号札が剥がれないか確認中...',
  '昇降口の靴の向きを揃えるよう案内を書いてます...',
  '体育着のサイズ別の在庫を業者に発注中...',
  '名札用の写真の背景を青一色に統一してます...',
  'クラス旗の候補を3案に絞ってます...',
  '応援歌の歌詞を印刷して全クラスに配る準備中...',
  '遠足のしおりの集合場所を地図で示してます...',
  '文化祭の役割をクラスごとの表に落としてます...',
  '卒業証書の用紙が届いたか業者に確認中...',
  '式典の来賓リストの敬称を統一してます...',
  '校庭の砂場の砂を業者で入れ替え予約中...',
  '花壇の苗を地域の園芸店で手配中...',
  'プールの水温計を校正してます...',
  'グラウンドの排水溝の蓋を全部開けて掃除してます...',
  '地域の方言を校歌の歌詞に一句だけ入れるか検討中...',
  '校門の植栽を地域の植木屋に頼んでます...',
  '創立者の肖像画の額縁を選んでます...',
  '近所の豆腐屋から給食の納品日を聞いてます...',
  '校庭の土のサンプルを業者に送ってます...',
  '職員室の冷蔵庫の霜取りをしてます...',
  '通学路の「こども110番」の家のリストを作ってます...',
  '校歌の1番の「朝日」を「夕日」に変えるか議論中...',
  '体育館のバスケのゴールの高さを測ってます...',
  '保健室の身長計の校正をしてます...',
  '図書室の「地域の本」コーナーの本を選んでます...',
  '校長の着任あいさつ文を下書きしてます...',
  '生徒会の選挙ポスターの貼り場所を確保中...',
  'プール開きのライフガードの手配をしてます...',
  '地域の古老の話をテープ起こししてます...',
  '校舎裏の立入禁止の理由を看板に短く書いてます...',
  '給食のアレルギー対応表を業者と突き合わせ中...',
  '職員の靴箱の番号を新年度の人事で振り直してます...',
  '体育祭の紅白の組み分けを抽選で決める準備中...',
  '文化祭のテーマをスローガンに縮めてます...',
  '修学旅行の部屋割りを男女・クラスで分けてます...',
  '校則の「服装」の写真を冬服・夏服で撮り直してます...',
  'PTAの初回会議のアジェンダを書いてます...',
  '消防団との避難訓練の想定火元を決めてます...',
  '朝礼台のマイクのフィードバックを抑える設定中...',
  '理科室のガス栓の安全キャップを全栓に付け直してます...',
  '音楽室の椅子の高さを平均身長で合わせてます...',
  '家庭科室のオーブンの予熱時間を計ってます...',
  '技術室の万力のネジが回るか点検してます...',
  '校長室のエアコンのリモコンを探してます...',
  '会議室の椅子の脚のキャップが取れてないか確認中...',
  '昇降口の傘立ての本数を雨の日想定で足してます...',
  '下駄箱の割り当て表を新入生名簿で作ってます...',
  '保健室のアイスパックを冷凍庫で冷やしてます...',
  '給食室の食器の数をクラス人数で割ってます...',
  '体育倉庫の跳び箱の段数を揃えてます...',
  '校庭のスプリンクラーのノズルを掃除してます...',
  '正門の校名プレートのネジを締め直してます...',
  '地域の農家の名前を給食の献立表に載せるか検討中...',
  '校舎の非常灯の電池を新品に替えてます...',
  '職員トイレの芳香剤を補充してます...',
  '教室の窓のストッパーが効くか点検してます...',
  '廊下の消火器の使い方を説明する紙を貼り直してます...',
  'グラウンドの夜間照明の照度を測ってます...',
  '校歌のCDの音量を体育館で試してます...',
  '入学式の保護者用パンフを折ってます...',
  '卒業式の花の色を校章に合わせてます...',
  '運動会のプログラムの表紙をデザインしてます...',
  '文化祭の出し物一覧を掲示用に大きく印刷してます...',
  '三者面談の時間の希望を保護者に取ってます...',
  '地域の神社の氏子さんに体育祭の日を伝えてます...',
  '公民館との会議室の予約を電話で確認中...',
  'スクールバス停の時刻表を業者と詰めてます...',
  '校庭のフェンスの補修を業者に見積もり依頼中...',
  '図書室の貸出カードの在庫を確認してます...',
  '給食の残渣を減らすキャンペーンの文言を考えてます...',
  '保健室の救急箱の鍵を職員室で管理するか検討中...',
  '体育館の窓の鍵を業者が来るまで仮の紐で縛ってます...',
  '職員室のプリンターの用紙を補充してます...',
  '校長の名刺の校名の表記を統一してます...',
  '校章入りの便箋を在庫してます...',
  '生徒手帳の校訓のページのレイアウトを直してます...',
  '時間割の「総合」の担当者を割り当て中...',
  '担任の自己紹介の写真を撮り直してます...',
  '部活動の顧問一覧の誤字を直してます...',
  '地域の偉人の生没年を校史と照合してます...',
  '校史の年表の西暦と和暦を両方書いてます...',
  '同窓会名簿の旧姓の扱いを決めてます...',
  '校報の初号の発行日を印刷所と合わせてます...',
  '校庭の桜の肥料を業者に相談してます...',
  '正門の門扉の鍵を3本用意してます...',
  'PTA会報の裏表紙に会員名簿を載せるか検討中...',
  '文化祭のパンフの裏に会場図を描いてます...',
  '体育祭のプログラムの余白に注意事項を詰め込んでます...',
  '卒業アルバムのクラスページの順番を決めてます...',
  '非常ベルの音が全館に聞こえるかテストしてます...',
  '蛍光灯の型番をメモして発注リストに追加してます...',
  '黒板消しのクリーニング業者を探してます...',
  '教壇のマイクのコードの長さを測ってます...',
  '廊下の掲示板のレイアウトを下書きしてます...',
  'トイレのスリッパの減り方を昨年と比較してます...',
  '自転車置き場の鍵の管理方法を決めてます...',
  '校舎の外壁の色を塗り直す業者を選んでます...',
  '屋上の手すりのさびを塗装で止めてます...',
  '校舎の写真の構図をパンフ用に crop してます...',
  '校則の「持ち物」のリストを今年度版に更新中...',
  '入学案内の「アクセス」のバス停名を実名で確認中...',
  '通学路の「危険箇所」を地図に赤で書き込んでます...',
  '避難経路の二次避難先を地域と確認中...',
  '職員の名札のクリップが壊れてないかチェックしてます...',
  '教室のカーテンの洗濯表示を確認してます...',
  '理科室の薬品の保管鍵を二重にしてます...',
  '音楽室のピアノの調律日を業者の予約表に書いてます...',
  '家庭科室のミシンの糸の色を補充してます...',
  '技術室ののこぎりの刃を研ぎ直してます...',
  '視聴覚室のスクリーンのシミを取る方法を調べてます...',
  'パソコン室のLANケーブルを全部抜き差ししてます...',
  '会議室のテーブルの脚を水平器で確認してます...',
  '校長室のソファの色を校章に合わせてます...',
  '保健室のベッドのシーツを洗濯してます...',
  '給食の献立表の栄養価を栄養士に計算してもらってます...',
  '下駄箱の番号の貼り位置を揃えてます...',
  '昇降口の「靴を揃えましょう」の張り紙を印刷してます...',
  '体育着のゼッケン番号をクラスで割り振ってます...',
  '名札用の写真の余白をトリミングしてます...',
  'クラス旗の投票用紙を印刷してます...',
  '応援歌の歌詞を拡大コピーして体育館に貼る準備中...',
  '遠足のしおりの「持ち物」を箇条書きで整理してます...',
  '文化祭の役割の空白を埋めるため再調整中...',
  '卒業証書の宛名を印刷するフォーマットを作ってます...',
  '式典の来賓の席次を案内図に落としてます...',
  '校庭の砂場の柵の高さを安全基準と照合してます...',
  '花壇の水やり当番を年間で割り振ってます...',
  'プールの塩素濃度の記録用紙を印刷してます...',
  'グラウンドのライン引きの道具を点検してます...',
  ...loadingMessages中盤,
  ...loadingMessages本番,
]

// 振動の上下幅にズレを出す用（非対称）
const VIBRATION_AMPLITUDES = [
  [0, 2.5, -2, 0],
  [0, 2, -2.8, 0],
  [0, 3, -1.5, 0],
  [0, 1.8, -2.5, 0],
  [0, 2.2, -2.2, 0],
]

export default function LoadingScreen() {
  const [messageIndex, setMessageIndex] = useState(0)
  const [progress, setProgress] = useState(0)
  const [elapsed, setElapsed] = useState(0)
  const [isResting, setIsResting] = useState(false)
  const [yKeyframes, setYKeyframes] = useState(VIBRATION_AMPLITUDES[0])

  useEffect(() => {
    // メッセージを1.5秒に1回のテンポで切り替え
    const messageInterval = setInterval(() => {
      setMessageIndex(prev => (prev + 1) % loadingMessages.length)
    }, 1500)

    // 経過時間で振動をどんどん速くする用
    const elapsedInterval = setInterval(() => {
      setElapsed(e => e + 0.25)
      setYKeyframes(() => VIBRATION_AMPLITUDES[Math.floor(Math.random() * VIBRATION_AMPLITUDES.length)])
    }, 250)

    return () => {
      clearInterval(messageInterval)
      clearInterval(elapsedInterval)
    }
  }, [])

  // 進捗バー：2分（120秒）で100%になるよう経過時間から計算（elapsed は 250ms ごとに +0.25 で約1/秒）
  useEffect(() => {
    const progressPercent = Math.min(100, (elapsed / 120) * 100)
    setProgress(progressPercent)
  }, [elapsed])

  // たまに疲れて止まる（ランダムで休憩）
  const restTimeoutRef = useRef<ReturnType<typeof setTimeout> | null>(null)
  useEffect(() => {
    if (isResting) return
    const scheduleRest = () => {
      const delay = 8000 + Math.random() * 12000 // 8〜20秒ごとに判定
      restTimeoutRef.current = setTimeout(() => {
        if (Math.random() < 0.22) {
          setIsResting(true)
          const restDuration = 2000 + Math.random() * 8000 // 2〜10秒休憩（ランダム）
          setTimeout(() => setIsResting(false), restDuration)
        }
        scheduleRest()
      }, delay)
    }
    scheduleRest()
    return () => {
      if (restTimeoutRef.current) clearTimeout(restTimeoutRef.current)
    }
  }, [isResting])

  // 経過＋進捗で振動周期を短く（最後はマジで速く）
  const vibrationDuration = Math.max(0.012, 0.07 - (elapsed / 70) * 0.048 - (progress / 100) * 0.02)

  // 工事の人が顔（丸枠）にズーム：2分で最大まで近づき（顔でいっぱい）、その後遠ざかり、ループ
  const elapsedSec = elapsed // 250ms ごとに +0.25 なので elapsed ≒ 経過秒
  const approachSec = 120 // 2分で最大接近
  const periodSec = approachSec * 2
  const t = elapsedSec % periodSec
  const scaleMax = 4.2
  const scaleRange = scaleMax - 1
  const workerScale = t < approachSec
    ? 1 + (t / approachSec) * scaleRange
    : scaleMax - ((t - approachSec) / approachSec) * scaleRange

  return (
    <div style={{
      position: 'fixed',
      inset: 0,
      background: 'linear-gradient(180deg, #0f1419 0%, #1a2332 50%, #0f1419 100%)',
      display: 'flex',
      flexDirection: 'column',
      alignItems: 'center',
      justifyContent: 'flex-start',
      paddingTop: '12vh',
      zIndex: 50
    }}>
      <div style={{ textAlign: 'center', padding: '0 1.5rem', maxWidth: '800px', width: '100%' }}>
        {/* 穴（白い円）は画面上部1/3。工事の人の顔がその位置で、顔を中心にゆっくりズーム */}
        <motion.div
          style={{
            marginBottom: '2rem',
            marginLeft: 'auto',
            marginRight: 'auto',
            width: '13rem',
            height: '13rem',
            background: '#fff',
            borderRadius: '50%',
            display: 'flex',
            alignItems: 'center',
            justifyContent: 'center',
            boxShadow: '0 0 32px rgba(0,0,0,0.25), 0 8px 24px rgba(0,0,0,0.2)',
            border: '4px solid rgba(0,0,0,0.08)',
            overflow: 'hidden'
          }}
        >
          <motion.img
            src="/loading-construction-worker.png"
            alt="工事中"
            style={{
              width: '9rem',
              height: 'auto',
              maxHeight: '10.5rem',
              objectFit: 'contain',
              display: 'block',
              transformOrigin: '50% 28%'
            }}
            animate={
              isResting
                ? { y: 0, scale: workerScale }
                : { y: yKeyframes, scale: workerScale }
            }
            transition={{
              scale: { duration: 0.3, ease: 'easeOut' },
              ...(isResting
                ? { y: { duration: 0.3, ease: 'easeOut' } }
                : {
                    y: {
                      duration: vibrationDuration,
                      repeat: Infinity,
                      ease: 'easeInOut'
                    }
                  })
            }}
          />
        </motion.div>

        {/* タイトル */}
        <motion.h2
          style={{
            fontFamily: 'var(--font-yuji-mai), "HGS行書体", "AR行書体M", cursive',
            fontSize: '3rem',
            fontWeight: 'bold',
            color: '#d4af37',
            marginBottom: '1.5rem',
            textShadow: '0 4px 8px rgba(0,0,0,0.8)',
            letterSpacing: '0.15em'
          }}
          initial={{ opacity: 0, y: -20 }}
          animate={{ opacity: 1, y: 0 }}
          transition={{ duration: 0.5 }}
        >
          学校建設中
        </motion.h2>
        <p style={{ fontSize: '0.9rem', color: 'rgba(240,230,210,0.8)', marginBottom: '1rem' }}>
          目安：約2分。最大5分程度かかることがあります。そのままお待ちください。
        </p>

        {/* ローディングメッセージ */}
        <div style={{ 
          height: '4rem', 
          marginBottom: '2rem',
          backgroundColor: 'rgba(212,175,55,0.1)',
          border: '2px solid rgba(212,175,55,0.3)',
          borderRadius: '8px',
          display: 'flex',
          alignItems: 'center',
          justifyContent: 'center',
          padding: '1rem'
        }}>
          <AnimatePresence mode="wait">
            <motion.p
              key={messageIndex}
              style={{
                fontSize: '1.25rem',
                color: '#f0e6d2',
                fontFamily: '"Noto Serif JP", serif',
                letterSpacing: '0.05em'
              }}
              initial={{ opacity: 0, y: 20 }}
              animate={{ opacity: 1, y: 0 }}
              exit={{ opacity: 0, y: -20 }}
              transition={{ duration: 0.5 }}
            >
              {loadingMessages[messageIndex]}
            </motion.p>
          </AnimatePresence>
        </div>

        {/* プログレスバー（幅固定でコメント文字量に左右されない） */}
        <div style={{ width: '100%', maxWidth: '400px', margin: '0 auto' }}>
          <div style={{ 
            width: '100%', 
            background: 'rgba(15,20,25,0.8)',
            borderRadius: '8px',
            height: '1.5rem',
            overflow: 'hidden',
            boxShadow: 'inset 0 2px 8px rgba(0,0,0,0.5)',
            border: '2px solid #8b7355'
          }}>
            <motion.div
              style={{
                height: '100%',
                background: 'linear-gradient(90deg, #d4af37 0%, #f4d03f 50%, #d4af37 100%)',
                boxShadow: '0 0 20px rgba(212,175,55,0.5)'
              }}
              initial={{ width: 0 }}
              animate={{ width: `${progress}%` }}
              transition={{ duration: 0.5 }}
            />
          </div>
          <p style={{
            color: '#d4af37',
            marginTop: '0.5rem',
            fontSize: '1rem',
            fontFamily: '"Noto Serif JP", serif',
            fontWeight: 'bold',
            letterSpacing: '0.1em',
            minHeight: '1.5em'
          }}>
            進捗率：{Math.round(progress)}%
          </p>
        </div>

        {/* ドット */}
        <div style={{ display: 'flex', justifyContent: 'center', marginTop: '2rem', gap: '0.5rem' }}>
          {[0, 1, 2].map((i) => (
            <motion.div
              key={i}
              style={{
                width: '0.75rem',
                height: '0.75rem',
                background: '#d4af37',
                borderRadius: '50%',
                boxShadow: '0 0 10px rgba(212,175,55,0.5)'
              }}
              animate={{
                scale: [1, 1.5, 1],
                opacity: [0.5, 1, 0.5],
              }}
              transition={{
                duration: 1.5,
                repeat: Infinity,
                delay: i * 0.2,
              }}
            />
          ))}
        </div>
      </div>
    </div>
  )
}
