# 🖼️ 画像生成機能のセットアップ

## 📋 概要

Replicate APIを使って、学校サイトの画像を自動生成します。

- **使用AI**: Stable Diffusion XL (SDXL)
- **料金**: 約0.3円〜1円/枚
- **無料枠**: 月50回まで無料
- **生成時間**: 5-10秒/枚

---

## 🚀 セットアップ手順

### ステップ1️⃣：Replicate アカウント作成

1. https://replicate.com/ にアクセス
2. 「Sign up」をクリック
3. GitHubアカウントでログイン

### ステップ2️⃣：APIトークン取得

1. ログイン後、右上のアイコンをクリック
2. 「Account settings」を選択
3. 左メニューから「API tokens」をクリック
4. 「Create token」をクリック
5. トークン名を入力（例：`school-ogiri-app`）
6. 「Create」をクリック
7. **表示されたトークンをコピー**（例：`r8_abc123...`）

### ステップ3️⃣：環境変数に設定

#### ローカル環境

`.env.local` ファイルに追加：

```bash
REPLICATE_API_TOKEN=r8_abc123...
```

#### Vercel環境

1. https://vercel.com/dashboard にアクセス
2. プロジェクトを選択
3. 「Settings」→「Environment Variables」
4. 「Add New」をクリック
5. 入力：
   - **Name**: `REPLICATE_API_TOKEN`
   - **Value**: `r8_abc123...`（コピーしたトークン）
   - **Environment**: 全部にチェック
6. 「Save」をクリック

### ステップ4️⃣：再デプロイ

Vercelで自動的に再デプロイされます。

---

## 💰 料金について

### 無料枠

- **月50回まで無料**
- 1回の学校生成で約21枚の画像
- **月2回まで無料**で学校生成可能

### 有料プラン

1回の学校生成：
- 画像21枚 × ¥0.5 = **約¥10.5**

月間コスト：
- 10回生成：約¥105
- 100回生成：約¥1,050
- 1,000回生成：約¥10,500

---

## 🔒 セキュリティ

- APIトークンはサーバーサイドのみで使用
- クライアントには露出しない
- 生成された画像は24時間で自動削除

---

## ⚙️ 機能の有効化/無効化

環境変数が設定されていない場合、自動的にプレースホルダー画像が使用されます。

```typescript
// 環境変数なし → プレースホルダー
REPLICATE_API_TOKEN=未設定
↓
https://placehold.co/600x400/...

// 環境変数あり → AI生成画像
REPLICATE_API_TOKEN=r8_abc123...
↓
https://replicate.delivery/pbxt/...
```

---

## 🎨 生成される画像

1. **校長先生の写真**
2. **部活動の写真**（吹奏楽部、サッカー部、茶道部）
3. **年間行事の写真**（入学式、体育祭、文化祭など）
4. **施設の写真**（図書館、体育館）
5. **制服の写真**（冬服、体操着）
6. **モニュメントの写真**（創立者像、石碑）

全て「**写ルンです風**」のレトロな雰囲気で生成されます！

---

## 🐛 トラブルシューティング

### 画像が生成されない

1. 環境変数が正しく設定されているか確認
2. Vercelを再デプロイ
3. ブラウザのコンソールでエラーを確認

### 料金が心配

1. Replicateダッシュボードで使用量を確認
2. 予算アラートを設定
3. 環境変数を削除すればプレースホルダーに戻る

---

## 📞 サポート

問題が発生した場合は、以下を確認してください：

- Replicate API トークンが有効か
- 環境変数が正しく設定されているか
- Vercelで再デプロイしたか

---

Happy generating! 🎨✨
