# 生成される学校サイト「あるべき構成」チェックリスト

生成完了後に、次の要素が **データとして存在するか・画面に表示されているか** を確認するための一覧です。

---

## ヘッダー（トップ）

| # | 項目 | データの場所 | 表示条件・備考 |
|---|------|--------------|----------------|
| 1 | ようこそメッセージ | `school_profile.name` | 「★☆ ようこそ〇〇ホームページへ！！！ ☆★」 |
| 2 | 学校名（テキスト） | `school_profile.name` | ロゴなし時は大きく表示 |
| 3 | ロゴ画像（横長バナー） | `school_profile.logo_url` | 生成またはプレースホルダー |
| 4 | 校章（円形） | `school_profile.emblem_url` | 生成またはプレースホルダー |
| 5 | タイトル下の帯 | `school_profile.sub_catchphrase` / `established` | 「〇〇 公式ホームページ」「創立 〇年」 |
| 6 | **校訓（黄枠の箱）** | `school_profile.motto` | ここが「？？？」になることがある → 要対策 |
| 7 | 背景リピートシンボル | `style_config.backgroundPattern.symbol` | 1文字。無い場合は非表示 |

---

## メインコンテンツ（表示順は defaultOrder または API の sectionOrder）

| # | セクション名 | データの場所 | 本来の内容 |
|---|--------------|--------------|------------|
| 8 | **お知らせ（news）** | `news_feed[]` | 5件。日付・カテゴリ・テキスト |
| 9 | **学校長挨拶（principal）** | `principal_message` | 名前・役職・挨拶文・**校長の顔写真** |
| 10 | **学校概要（overview）** | `school_profile.overview` | 概要文＋**現校舎の画像**1枚 |
| 11 | **校歌（anthem）** | `school_anthem` | タイトル・歌詞（1番2番3番）・**音声プレーヤー**・挿絵エリア |
| 12 | **生徒心得（rules）** | `crazy_rules[]` | 5条 |
| 13 | **年間行事（events）** | `multimedia_content.school_events[]` | 1件。名前・日付・説明・**画像1枚** |
| 14 | **部活動（clubs）** | `multimedia_content.club_activities[]` | 1件。名前・説明・**画像1枚** |
| 15 | **校訓（motto）** | 校訓ブロック | 初代校舎写真1枚＋**校訓1文字（『 』）**＋サブキャッチ＋校訓全文 |
| 16 | **施設紹介（facilities）** | `multimedia_content.facilities[]` | 3件。名前・説明（写真なし） |
| 17 | **銅像（monument）** | `multimedia_content.monuments[]` | 1件。創立者像の**写真**・名前・説明 |
| 18 | **制服紹介（uniform）** | `multimedia_content.uniforms[]` | 1件。**制服写真**・説明 |
| 19 | **沿革（history）** | `history[]` | 年表＋**初代校舎の画像**1枚 |
| 20 | **教職員紹介（teachers）** | `teachers[]` | 3名。名前・担当・説明（写真は校長のみ） |

※「校舎の歴史」セクションは**非表示**（初代・現校舎の画像は上記の概要・校訓・沿革で使用）。

---

## 画像として生成されるもの（計8種）

| # | 種別 | データの場所 | 備考 |
|---|------|--------------|------|
| 21 | 校章 | `school_profile.emblem_url` | |
| 22 | 初代校舎 | `school_profile.historical_buildings[0].image_url` | 校訓・沿革で使用 |
| 23 | 現校舎 | `school_profile.historical_buildings[最後].image_url` | 学校概要で使用 |
| 24 | 校長の顔 | `principal_message.face_image_url` | |
| 25 | 銅像（創立者像） | `multimedia_content.monuments[0].image_url` | |
| 26 | 制服 | `multimedia_content.uniforms[0].image_url` | |
| 27 | 年間行事1枚 | `multimedia_content.school_events[0].image_url` | |
| 28 | 部活動1枚 | `multimedia_content.club_activities[0].image_url` | |

---

## サイドバー（two-column レイアウト時）

| # | 項目 | データの場所 |
|---|------|--------------|
| 29 | アクセス | `access` |
| 30 | 著名な卒業生 | `notable_alumni[]` |
| 31 | 教職員紹介（短い版） | `teachers[]` |

---

## 足りていないときに疑うこと

- **テキストがモック** → 画面上部に「APIエラーのため…ダミー（モック）です」と出る。Comet チャットのモデルID・503 を解消する。
- **セクションが少ない** → API が返す `style_config.sectionOrder` が短い、または該当データが空で `sections[key]` が null になっている。
- **画像がプレースホルダー** → 画像生成 API が失敗している、または `image_prompt` が空でタスクに含まれていない。Vercel ログで `generate-school-image` を確認。
- **校歌の音声が出ない** → Suno の URL が期限切れ or 未生成。「音声生成を再試行」で再取得。
- **トップの「？？？」** → 校訓（motto）や校訓1文字（motto_single_char）に、フォントが持っていない文字が入っている。表示を隠す or 代替文字に差し替える対策を入れる。

---

## 参照

- セクションのキー一覧: `defaultOrder`（`SchoolWebsite.tsx`）
- 画像タスク: `lib/inngest/functions/school-generate.ts` の `collectImageTasks`
- プロンプトのスキーマ: `app/api/generate-school/route.ts` の `systemPrompt`
