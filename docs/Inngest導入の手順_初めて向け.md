# Inngest 導入の手順（初めての人向け・超ていねい版）

「ターミナルってどこ？」「npm install はどこに入れるの？」というレベルから、順番に説明します。

---

## ⚠️ Node を入れられない場合（ローカルで npm が使えない場合）

**パソコンに Node を入れられない・入れない**場合は、次のようにします。

- **ターミナルでの `npm install` と `npm run dev` はやらない。**
- **コードは Cursor で編集** → **Git で GitHub などにプッシュ** → **Vercel が自動でビルド・実行**する流れにする。
- Vercel の側で `npm install` とビルドが行われるので、あなたのパソコンに Node は不要です。
- 動作確認は、Vercel の「デプロイが完了したURL」をブラウザで開いて行います。

具体的な手順は、このドキュメントの **「Node を入れられない人用の手順」** の節を見てください（下の方にあります）。

---

## 用語の説明（いまだけ読めばOK）

- **ターミナル** … 黒い（または白い）画面に文字だけ打ち込むところ。Mac なら「ターミナル」アプリ、Windows なら「コマンドプロンプト」や「PowerShell」。
- **コマンド** … ターミナルに打ち込む命令。「npm install」もコマンドのひとつ。
- **プロジェクトのフォルダ** … このアプリの入っているフォルダ。Cursor で開いている「school-ogiri-app」がその中身です。パスで言うと `Desktop/plan02/school-ogiri-app` のような場所。

---

## 手順 1：ターミナルを開く

1. **Mac の場合**
   -  Spotlight（画面右上の虫眼鏡）を押す
   - 「ターミナル」と入力して Enter
   - または Finder → アプリケーション → ユーティリティ → 「ターミナル」をダブルクリック

2. **Windows の場合**
   - スタートメニューで「cmd」または「PowerShell」と検索して開く

黒（または白）い画面が出て、どこかに `$` や `>` のような記号が点滅していればOKです。ここに「コマンド」を打ちます。

---

## 手順 2：プロジェクトのフォルダに移動する

ターミナルは「いまどのフォルダにいるか」が重要です。**このアプリのフォルダの中にいる**状態にします。

1. Cursor の左側のファイル一覧で、一番上の「school-ogiri-app」を右クリック
2. 「Reveal in Finder」（Mac）または「エクスプローラーで表示」（Windows）を選ぶ
3. 開いたフォルダの**上にあるパス（住所）**を確認する  
   例：`/Users/あなたの名前/Desktop/plan02/school-ogiri-app`

4. ターミナルに、次のように**1行ずつ**打ち込みます（あなたの環境に合わせて変えてください）。

   **Mac で Desktop の plan02 にある場合の例：**
   ```bash
   cd ~/Desktop/plan02/school-ogiri-app
   ```
   打ち終えたら **Enter** を押す。

   **Windows の例：**
   ```bash
   cd Desktop\plan02\school-ogiri-app
   ```
   （あなたの実際のパスが違う場合は、そのパスに書き換える。`cd` のあとに半角スペースを1つ入れてからパスを書く。）

5. もう一度 Enter を押すと、ターミナルの先頭の表示が、そのフォルダの名前（例：`school-ogiri-app`）に変わるはずです。  
   → これで「プロジェクトのフォルダにいる」状態になりました。

---

## 手順 3：npm install を実行する

1. ターミナルで、次の文字を**そのまま**打ち込む：
   ```bash
   npm install
   ```
2. **Enter** を押す。
3. しばらく（数十秒〜1分）待つ。たくさん文字が流れて、最後にまた `$` や `>` が出てきたら終わりです。
4. 「error」と出た場合は、そのメッセージをそのままコピーして、誰かに聞くか検索するとよいです。  
   うまくいった場合は、特に「成功しました」とは出ませんが、エラーがなければOKです。

**まとめ：npm install は「ターミナル」に打ち込んで、Enter で実行します。** プロジェクトのフォルダ（school-ogiri-app）に移動したあとで実行する、という順番が大事です。

---

## 手順 4：Vercel KV を用意する（データの保存場所）

ここは**ブラウザ**で作業します。

1. **Vercel** にログインする  
   https://vercel.com を開いて、このアプリをデプロイしているアカウントでログイン。

2. **プロジェクトを開く**  
   ダッシュボードから「school-ogiri-app」（またはあなたがつけた名前）のプロジェクトをクリック。

3. **Storage を開く**  
   画面上方のタブで「Storage」をクリック。

4. **KV を作る**  
   - 「Create Database」をクリック  
   - 「KV」を選ぶ  
   - 名前を入れる（例：`school-ogiri-kv`）  
   - 作成する

5. **プロジェクトにつなぐ**  
   作成した KV の画面で「Connect to Project」をクリックし、今のプロジェクト（school-ogiri-app）を選ぶ。  
   → すると「環境変数が追加されました」のような表示になる。  
   これで、Vercel にデプロイしたときは自動で KV が使われます。

6. **ローカル（自分のパソコン）で動かすとき**  
   - 同じ Storage の画面で、作った KV をクリック  
   - 「.env.local」や「Environment Variables」のようなところを開く  
   - そこに書いてある `KV_REST_API_URL` と `KV_REST_API_TOKEN` の**値**をコピーする  
   - Cursor でプロジェクトを開き、左のファイル一覧の**一番上（school-ogiri-app の直下）**に、  
     **`.env.local`** というファイルがあるか確認する  
   - ない場合：右クリック →  New File → 名前を `.env.local` にする  
   - `.env.local` を開いて、次のように書く（`=` の右は、Vercel でコピーした**実際の値**に置き換える）：
     ```
     KV_REST_API_URL=ここにコピーしたURL
     KV_REST_API_TOKEN=ここにコピーしたトークン
     ```
   - 保存する（Ctrl+S / Cmd+S）

---

## 手順 5：Inngest を用意する（ジョブを動かす仕組み）

1. ブラウザで **https://app.inngest.com** を開く。
2. アカウントを作るか、ログインする。
3. 「Create App」などでアプリを 1 つ作る（名前は何でもよい）。
4. 画面に **Signing Key** が表示されるので、コピーする。
5. **Vercel** に戻る → 同じプロジェクト → **Settings** → **Environment Variables**。
6. 「Add New」で次のように 1 つ追加する：
   - **Name**: `INNGEST_SIGNING_KEY`
   - **Value**: さっきコピーした Signing Key を貼り付ける
7. 保存する。

※ いったんローカルだけで試すだけなら、この手順 5 は後回しでも大丈夫です（Inngest の開発用サーバーを使う場合は別途説明が必要なら、そのとき聞いてください）。

---

## 手順 6：アプリを起動して確認する

1. ターミナルで、**まだプロジェクトのフォルダにいる**ことを確認する（手順 2 の状態）。
2. 次のコマンドを打って Enter：
   ```bash
   npm run dev
   ```
3. 「Local: http://localhost:3000」のような表示が出たら、ブラウザでその URL を開く。
4. 学校おぎりアプリの画面が出れば、ここまでの設定はできています。

---

## Node を入れられない人用の手順（ターミナル・npm は使わない）

**パソコンに Node を入れられない・入れない**ときは、次の順番で進めます。ターミナルでは何も打ちません。

### 1. コードは Cursor で編集するだけ

- `npm install` は**しなくてよい**。Vercel がデプロイ時に自動で実行します。
- 必要なコード変更（Inngest・KV の API、および**フロントの「ジョブ＋ポーリング」への変更**）は、すでにプロジェクトに入っています。`app/page.tsx` は「ピン選択 → ジョブ開始 → ポーリングで完了待ち」の流れになっています。

### 2. Vercel で KV を作る

- ブラウザで **vercel.com** にログイン → このプロジェクトを開く。
- **Storage** タブ → **Create Database** → **KV** を選んで作成。
- 作成した KV の **Connect to Project** で、このプロジェクトを選ぶ。  
  → 本番用の環境変数（`KV_REST_API_URL` など）が自動で付きます。

### 3. Inngest の Signing Key を Vercel に入れる

- ブラウザで **app.inngest.com** を開く → アプリを作成 or ログイン。
- 表示される **Signing Key** をコピー。
- **Vercel** → 同じプロジェクト → **Settings** → **Environment Variables**。
- **Add New** で、Name: `INNGEST_SIGNING_KEY`、Value: コピーした Signing Key を貼り付けて保存。

### 4. コードを Git でプッシュする（ていねいな手順）

以下、Cursor でやる手順です。

1. **Source Control を開く**  
   - Cursor の**左側の縦バー**で、**枝が二股になっているマーク**（Source Control）をクリック。  
   - または メニュー **View** → **Source Control**。

2. **変更一覧を確認する**  
   - 「Changes」の下に、変更したファイル名（例：`app/page.tsx` など）が並びます。  
   - 横の **＋** を押すと「ステージング」され、コミットの対象になります。  
   - **全部まとめてステージングする**なら、「Changes」の右にある **＋**（Changes の横）を押す。

3. **コミットする**  
   - 上の **メッセージ欄**（「Message」と書いてあるところ）に、何をしたか短く書く。  
     例：`Inngest で学校生成をジョブ化、フロントをポーリングに変更`  
   - **✓ マークのボタン**（Commit）をクリック。  
   - 「コミットしました」のように出ればOK。

4. **変更を 1 つだけコミットしてプッシュするとき（ていねいな手順）**

   **左側の Source Control を使う場合：**

   - **Source Control を開く**  
     Cursor の**左の縦バー**（ファイル一覧があるところ）で、**上から 3 つ目あたり**にある **枝が二股に分かれたアイコン** をクリックする。これが「Source Control」です。クリックすると、左側のパネルが「変更」（Changes）の一覧に切り替わる。

   - **変更を確認する**  
     「変更」または「Changes」という見出しの下に、変更されたファイル名が並ぶ。  
     例：`.babelrc` の横に **D** や「削除」と出ていれば、そのファイルが削除された変更。

   - **ステージングする（コミットの対象にする）**  
     コミットしたいファイルの行の**右側**に、**「+」** や **「ステージ」** のようなボタンがある。それをクリックすると、その変更が「ステージされている変更」の欄に移動する。  
     **全部まとめてステージする**場合は、「変更」という見出しの**右横**にある **「+」**（Changes の横のプラス）を 1 回クリックする。

   - **コミットメッセージを書く**  
     ステージしたあと、Source Control パネルの**一番上**に「メッセージ」や「Message」と書いてある**入力欄**がある。そこに、何をしたか短く書く。  
     例：`.babelrc を削除して SWC でビルドする`  
     書いたら、その下にある **チェックマーク（✓）のボタン「コミット」** をクリックする。

   - **プッシュする**  
     コミットが終わると、画面上部や Source Control 内に **「Sync Changes」** や **「↑ 1」**（上向き矢印と数字）が出ることがある。それをクリックすると GitHub に送られる。  
     出ていない場合は、**Ctrl+Shift+P**（Mac は **Cmd+Shift+P**）→ **「push」** と入力 → **「Git: Push」** を選ぶ。

4. **プッシュする（GitHub に送る）**  
   - **どこを探すか**  
     - 左の **Source Control** を開いたまま、**一番下**を見る。  
     - 「○○ の変更をプッシュする」「Sync Changes」「↑ 1」のような**青いリンクやボタン**が出ていることがあります。それをクリックするとプッシュされます。  
     - または、Cursor の**左下**（ステータスバー）に「main」や「master」のような**ブランチ名**が表示されていることがあります。そのあたりをクリックすると、上にメニューが出て、その中に **「Push」** や **「Sync」** があります。  
   - **別のやり方（確実な方法）**  
     - キーボードで **Ctrl+Shift+P**（Mac は **Cmd+Shift+P**）を押す。  
     - 上に「コマンドを入力してください」のような**入力欄**が出る。  
     - そこに **`push`** または **`プッシュ`** と打つ。  
     - 一覧に **「Git: Push」** や **「Git: Sync」** が出るので、それを**クリック**する（Enter でも可）。  
   - **初回だけ**：GitHub にまだログインしていない場合は、「GitHub でサインイン」のような表示が出るので、案内に従ってブラウザでログインする。  
   - 成功すると、Source Control の「変更」がなくなり、Vercel が自動でデプロイを始めます。

5. **Vercel と GitHub がつながっているか**  
   - 初めてこのリポジトリを Vercel でデプロイする場合は、**Vercel** → **Add New** → **Project** → **Import Git Repository** で、このプロジェクトの GitHub リポジトリを選んでおく。  
   - すでに「学校大喜利アプリ」が GitHub とつながっていれば、プッシュするだけで Vercel が自動でビルド・デプロイします。

### 5. プッシュできたか GitHub で確認する（ていねいな手順）

「リポジトリがわからない」ときは、次の順番で進めます。

1. **GitHub のサイトを開く**  
   ブラウザで **https://github.com** を開く。表示されたら**ログイン**する（右上の Sign in）。

2. **「自分のリポジトリ一覧」を開く**  
   - ログイン後、**左上のネコのアイコン（GitHub のロゴ）** をクリック → トップページに行く。  
   - トップページの**右上**に、自分のアイコンがある。その**アイコンをクリック**する。  
   - 出てきたメニューの中から **「Your repositories」**（あなたのリポジトリ）をクリックする。  
   - または、画面上部の検索欄の横あたりにある **「Repositories」** をクリックしても、自分のリポジトリ一覧が出ます。

3. **「学校おぎり」のリポジトリを探す**  
   - 一覧に、あなたが作った（または Cursor で作った）**リポジトリ名**が並んでいます。  
   - 名前は、例えば **「school-ogiri-app」** や **「plan02」**、**「フリシボリ」** など、フォルダ名やプロジェクト名に近いことが多いです。  
   - **「学校」「ogiri」「school」「plan」** などが入っている名前を探して、その**行をクリック**する。  
   - クリックすると、そのリポジトリの**中身のページ**が開きます。

4. **「main」ブランチを確認する**  
   - リポジトリのページを開いたら、**ファイル一覧の上**（コードが表示されているあたり）に、**「main」** または **「master」** と書いてある**ボタンやドロップダウン**があります。  
   - そこに **「main」** と表示されていれば、main ブランチが見えている状態です。そのままでOKです。

5. **「最新のコミット」を確認する**  
   - 同じページで、**ファイル一覧のいちばん上**（`app` や `docs` などのフォルダが並んでいる少し上）に、**直近のコミットのメッセージ**が 1 行で出ています。  
   - 例：「Inngest で学校生成をジョブ化、フロントをポーリングに変更」や、「Update …」など。  
   - そこに **「Inngest で学校生成をジョブ化、フロントをポーリングに変更」** とあれば、そのコミットは **GitHub にプッシュできています**。

6. **ファイルの中身を確認する（任意）**  
   - 同じページで、**`app`** というフォルダ名をクリックする。  
   - 次に **`page.tsx`** をクリックする。  
   - 中身に **「generate-job」** や **「/api/job」** という文字が含まれていれば、ジョブ＋ポーリング用の変更が GitHub に反映されています。

**リポジトリ名がどうしてもわからない場合**  
   - Cursor の **Source Control** を開き、**「⋯」**（3点リーダー）や **「Remote」** などから **「リモートの URL を表示」** のような項目を探す。  
   - 表示された URL が `https://github.com/あなたのユーザー名/リポジトリ名` のような形なので、**リポジトリ名**は最後の `/` の後ろの部分です。  
   - その URL をブラウザに貼り付けて開くと、そのリポジトリのページに直接行けます。

### 6. 動作確認は Vercel の URL で

- プッシュすると Vercel が自動でビルドします。
- デプロイが終わったら、Vercel の **Deployments** に出ている **URL** をブラウザで開く。
- その URL で学校おぎりアプリが開き、ピン選択 → 学校生成が動けばOKです。

**まとめ（Node を入れられない場合）**: ターミナル・npm は使わず、Vercel で KV と Inngest の環境変数を設定し、コードを Git でプッシュ。確認は Vercel のデプロイURLで行う。

---

## まとめ（「何をしたか」の整理）

| 番号 | やったこと | どこでやったか |
|------|------------|----------------|
| 1 | ターミナルを開いた | Mac: Spotlight で「ターミナル」、Windows: cmd や PowerShell |
| 2 | プロジェクトのフォルダに移動した | ターミナルに `cd ...` と打った |
| 3 | `npm install` を実行した | ターミナルに `npm install` と打って Enter |
| 4 | Vercel で KV を作ってプロジェクトにつないだ | ブラウザで Vercel → Storage |
| 4 の続き | ローカル用に `.env.local` に KV の値を書いた | Cursor で `.env.local` を編集 |
| 5 | Inngest の Signing Key を Vercel の環境変数に入れた | ブラウザで Vercel → Settings → Environment Variables |
| 6 | `npm run dev` でアプリを起動した | ターミナルに `npm run dev` と打って Enter |

**「npm install はターミナルに入れるの？」→ はい。プロジェクトのフォルダに移動したあと、ターミナルに `npm install` と打って Enter でOKです。**

ここまでできたら、フロントを「ジョブ＋ポーリング」に変える作業（別のドキュメントの手順 5）に進めます。どこで詰まったか教えてもらえれば、そのステップだけさらに細かく書けます。
